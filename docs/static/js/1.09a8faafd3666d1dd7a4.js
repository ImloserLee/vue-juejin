webpackJsonp([1,7],{EFoe:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"header"},[this._m(0),this._v(" "),e("div",{staticClass:"header_right"},[e("span",{staticClass:"icon"},[e("svg-icon",{attrs:{iconClass:"category"}})],1),this._v(" "),e("span",{staticClass:"icon"},[e("svg-icon",{attrs:{iconClass:"add"}})],1)]),this._v(" "),e("i",{staticClass:"bar"})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header_left"},[e("span",{staticClass:"title"},[this._v("首页")])])}]};var i=n("VU/8")({},a,!1,function(t){n("t1/9")},"data-v-9dd07a70",null);e.default=i.exports},XzY5:function(t,e,n){"use strict";var a=n("oAV5"),i={props:{timeline:{type:Array,default:function(){return[]}}},filters:{splitTag:function(t){return t.slice(0,2).map(function(t,e){return t.title}).join("/")}},methods:{handleToDetail:function(t){var e=Object(a.c)(t.originalUrl),n=t.objectId,i=t.type,s={id:"post"===i?e:n,type:i};this.$emit("toDetail",s)},handleToHomePage:function(t){var e=t.user.objectId;this.$emit("toHomePage",e)},handleSetUserLike:function(t){var e=t.objectId;this.$emit("setUserLike",e)},handleCancelUserLike:function(t){var e=t.objectId;this.$emit("cancelUserLike",e)}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",t._l(t.timeline,function(e){return n("li",{key:e.objectId,staticClass:"list"},[n("div",{staticClass:"panel"},[n("div",{staticClass:"header"},[n("div",{staticClass:"header_left",on:{click:function(n){t.handleToHomePage(e)}}},[n("div",{staticClass:"avatar"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.user.avatarLarge,expression:"item.user.avatarLarge"}]})]),t._v(" "),n("div",{staticClass:"name"},[t._v("\n            "+t._s(e.user.username)+"\n          ")])]),t._v(" "),n("div",{staticClass:"header_right",on:{click:function(n){t.handleToDetail(e)}}},[n("span",[t._v(t._s(t._f("splitTag")(e.tags)))])])]),t._v(" "),n("div",{staticClass:"content",on:{click:function(n){t.handleToDetail(e)}}},[n("div",{staticClass:"content_left"},[n("h4",[t._v(t._s(e.title))]),t._v(" "),n("div",{staticClass:"text"},[n("p",[t._v(t._s(e.content))])])]),t._v(" "),e.screenshot?n("div",{staticClass:"content_right"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.screenshot,expression:"item.screenshot"}]})]):t._e()]),t._v(" "),n("div",{staticClass:"bar"},[n("div",{staticClass:"like"},[e.isCollected?n("span",{staticClass:"icon",on:{click:function(n){t.handleCancelUserLike(e)}}},[n("svg-icon",{attrs:{iconClass:"dianzan-fill"}})],1):n("span",{staticClass:"icon",on:{click:function(n){t.handleSetUserLike(e)}}},[n("svg-icon",{attrs:{iconClass:"dianzan"}})],1),t._v(" "),e.collectionCount?n("span",{staticClass:"text",class:e.isCollected?"like-text":""},[t._v(t._s(e.collectionCount))]):n("span",{staticClass:"text"},[t._v("点赞")])]),t._v(" "),n("div",{staticClass:"comment"},[n("span",{staticClass:"icon"},[n("svg-icon",{attrs:{iconClass:"pinlun"}})],1),t._v(" "),e.commentsCount?n("span",{staticClass:"text"},[t._v(t._s(e.commentsCount))]):n("span",{staticClass:"text"},[t._v("评论")])])])])])}))},staticRenderFns:[]};var o=n("VU/8")(i,s,!1,function(t){n("ju5e")},"data-v-64203f29",null);e.a=o.exports},ju5e:function(t,e){},"t1/9":function(t,e){},wXUp:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Dd8w"),i=n.n(a),s=n("Xxa5"),o=n.n(s),r=n("exGp"),c=n.n(r),l=(n("7+uW"),n("H868")),d=n("EFoe"),u=n("XzY5"),h=n("/mXm"),v=n("NYxO"),m=n("vsZy"),f=n("P9l9"),p={name:"Home",data:function(){return{hotRecommentData:[],timelineData:[],showHotRecomment:!0,rotate:!1}},mixins:[m.a],components:{HotRecomment:h.a,Scroll:l.a,VHeader:d.default,ItemPane:u.a},activated:function(){var t=this;this.$nextTick(function(){t.$refs.scroll.refresh()})},mounted:function(){this.getEntryByHotRecomment(),this.auth?this.getEntryByTimeline(!0):this.getEntryByRank(!0)},methods:{getEntryByHotRecomment:function(){var t=this;return c()(o.a.mark(function e(){var n,a,i,s,r,c,l,d;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth?t.auth:"",a=n.token,i=void 0===a?"":a,s=n.uid,r=void 0===s?"unlogin":s,c=n.device_id,l={params:{src:"ios",limit:20,token:i,device_id:void 0===c?"":c,uid:r}},e.next=4,f.a.getEntryByHotRecomment(l);case 4:"ok"===(d=e.sent).m&&(t.hotRecommentData=d.d.entry.entrylist.slice(0,3));case 6:case"end":return e.stop()}},e,t)}))()},handleRefreshRecomment:function(){var t=this;return c()(o.a.mark(function e(){var n,a,i,s,r,c,l,d,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.rotate=!0,n=setTimeout(function(){t.rotate=!1,clearTimeout(n)},800),a=(a=t.hotRecommentData.map(function(t){return t.objectId})).join("|"),i=t.auth?t.auth:"",s=i.token,r=void 0===s?"":s,c=i.uid,l=void 0===c?"unlogin":c,d=i.device_id,u={params:{src:"ios",entryId:a,token:r,uid:l,device_id:void 0===d?"":d}},e.next=8,f.a.refreshHotRecomment(u);case 8:"ok"===e.sent.m&&t.getEntryByHotRecomment();case 10:case"end":return e.stop()}},e,t)}))()},getEntryByTimeline:function(t){var e=this;return c()(o.a.mark(function n(){var a,i,s,r,c,l,d,u,h,v,m,p;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.auth?e.auth:"",i=a.token,s=void 0===i?"":i,r=a.uid,c=void 0===r?"unlogin":r,l=a.device_id,d=void 0===l?"":l,(u=e.timelineData).length&&!t||(u=[{verifyCreatedAt:""}]),h=u.slice(-1)[0].verifyCreatedAt||"",v={params:{src:"ios",limit:20,before:h,token:s,device_id:d,uid:c}},n.next=7,f.a.getEntryByTimeline(v);case 7:1===(m=n.sent).s&&(p=m.d.entrylist?m.d.entrylist:[],e.timelineData=t?p:e.timelineData.concat(p.slice(1)));case 9:case"end":return n.stop()}},n,e)}))()},getEntryByRank:function(t){var e=this;return c()(o.a.mark(function n(){var a,i,s,r,c,l,d,u,h,v,m,p;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.auth?e.auth:"",i=a.token,s=void 0===i?"":i,r=a.uid,c=void 0===r?"unlogin":r,l=a.device_id,d=void 0===l?"":l,(u=e.timelineData).length&&!t||(u=[{rankIndex:""}]),h=u.slice(-1)[0].rankIndex||"",v={params:{src:"ios",limit:20,uid:c,device_id:d,token:s,before:h}},n.next=7,f.a.getEntryByRank(v);case 7:1===(m=n.sent).s&&(p=m.d&&m.d.entrylist||[],e.timelineData=t?p:e.timelineData.concat(p.slice(1)));case 9:case"end":return n.stop()}},n,e)}))()},handleSetUserLike:function(t){var e=this;return c()(o.a.mark(function n(){var a,i,s,r,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.auth,i=a.uid,s=a.device_id,r=a.token,c={objectId:t,uid:i,device_id:s,token:r},n.next=4,f.a.setUserLike(c);case 4:1===n.sent.s&&e.handleToggleCollecte(t,"add");case 6:case"end":return n.stop()}},n,e)}))()},handleCancelUserLike:function(t){var e=this;return c()(o.a.mark(function n(){var a,i,s,r,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.auth,i=a.uid,s=a.device_id,r=a.token,c={objectId:t,uid:i,device_id:s,token:r},n.next=4,f.a.cancelUserLike(c);case 4:1===n.sent.s&&e.handleToggleCollecte(t,"minus");case 6:case"end":return n.stop()}},n,e)}))()},handleToHomePage:function(t){this.$router.push({path:"/homepage",query:{id:t}})},handleToLogin:function(){var t=this.$route.path;this.$router.push({path:"/login",query:{url:t}})},handleToggleCollecte:function(t,e){for(var n=this.timelineData,a=0;a<n.length;a++)n[a].objectId===t&&(n[a].isCollected=!n[a].isCollected,"add"===e?n[a].collectionCount++:n[a].collectionCount--)},handleColseRecomment:function(){this.showHotRecomment=!1},handlePullDown:function(){this.auth?this.getEntryByTimeline(!0):this.getEntryByRank(!0)},handlePullUp:function(){this.auth?this.getEntryByTimeline():this.getEntryByRank()},handleToDetail:function(t){this.$router.push({path:"detail",query:{id:t.id,type:t.type}})}},computed:i()({},Object(v.b)(["isLogin","auth"])),watch:{$route:function(t,e){"/login"===e.path&&(this.getEntryByHotRecomment(),this.auth?this.getEntryByTimeline(!0):this.getEntryByRank(!0))}}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("v-header"),t._v(" "),n("scroll",{ref:"scroll",staticClass:"scroll",attrs:{data:t.timelineData,scrollbar:t.scrollbarObj,pullDownRefresh:t.pullDownRefreshObj,pullUpLoad:t.pullUpLoadObj},on:{pullingDown:t.handlePullDown,pullingUp:t.handlePullUp}},[n("div",{staticClass:"section"},[t.isLogin?t._e():n("div",{staticClass:"logincard"},[n("div",{staticClass:"logincard_left"},[n("p",{staticClass:"title"},[t._v("登陆账号")]),t._v(" "),n("p",{staticClass:"desc"},[t._v("收藏文章,同步阅读记录,数据永不消失")])]),t._v(" "),n("div",{staticClass:"logincard_right"},[n("span",{staticClass:"login",on:{click:t.handleToLogin}},[t._v("登陆")])])]),t._v(" "),t.showHotRecomment&&t.hotRecommentData.length?n("hot-recomment",{attrs:{recomment:t.hotRecommentData,rotate:t.rotate},on:{closeRecomment:t.handleColseRecomment,refreshRecomment:t.handleRefreshRecomment,toDetail:t.handleToDetail}},[n("span",{staticClass:"txt",attrs:{slot:"text"},slot:"text"},[t._v("热门推荐")])]):t._e(),t._v(" "),n("item-pane",{attrs:{timeline:t.timelineData},on:{toDetail:t.handleToDetail,toHomePage:t.handleToHomePage,setUserLike:t.handleSetUserLike,cancelUserLike:t.handleCancelUserLike}})],1)])],1)},staticRenderFns:[]};var g=n("VU/8")(p,_,!1,function(t){n("yykh")},"data-v-4594490a",null);e.default=g.exports},yykh:function(t,e){}});
//# sourceMappingURL=1.09a8faafd3666d1dd7a4.js.map